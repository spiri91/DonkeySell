function productController(n,t,i,r,u,f,e,o,s,h,c,l){n.id=u.productId;n.product={};n.productOwner={};n.messages=[];n.newMessage="";n.selectedImage="";n.endOfListToRight=!1;n.endOfListToLeft=!1;n.mapReady=!1;var a;n.init=function(){n.getProductAndProductOwner();n.getMessages()};n.getProductOwner=function(){r.getUser(n.product.userName).then(function(t){t.data&&(n.productOwner=t.data)},function(t){n.doSomethingWithError(t)})};n.nextProduct=function(){let t=c.getNextProduct(n.product.id);t===null?c.getNextProducts().then(function(t){n.checkEndOfListToRight(t)||n.getProductsForNavigation(t,!1)}):n.goToProduct(t)};n.checkEndOfListToRight=function(t){return t===undefined||t.data.products.length===0?(n.endOfListToRight=!0,!0):!1};n.previousProduct=function(){let t=c.getPreviousProduct(n.product.id);t===null?c.getPreviousProducts().then(function(t){n.checkEndOfListToLeft(t)||n.getProductsForNavigation(t,!0)}):n.goToProduct(t)};n.checkEndOfListToLeft=function(t){if(t===undefined||t.data.products.length===0)return n.endOfListToLeft=!0,!0;let i=t.data.products[0];return c.checkIfIdIsAllreadyAdded(i.id)?(n.endOfListToLeft=!0,!0):!1};n.getProductsForNavigation=function(t,i){let u=t.data.products.map(function(n){return n.id});c.setProductsIds(u,i);let r;r=i===!0?c.getPreviousProduct(n.product.id):c.getNextProduct(n.product.id);n.goToProduct(r)};n.goToProduct=function(n){n!==undefined&&l.url("/product/"+n)};n.showGridBottomSheet=function(){n.alert="";s.show({templateUrl:"Site/product/contactPage/contactPage.html",controller:"contactPageController",locals:{Item:{phone:n.productOwner.phone,facebook:n.productOwner.facebook,email:n.productOwner.email,twitter:n.productOwner.twitter}},clickOutsideToClose:!0})};n.getProductAndProductOwner=function(){i.getProduct(n.id).then(function(t){t.data&&(n.product=t.data,n.selectedImage=n.product.images[0]?n.product.images[0].value:"")},function(t){n.doSomethingWithError(t)}).then(function(){n.getProductOwner()})};n.getMessages=function(){t.getMessagesForProduct(n.id).then(function(t){t.data&&(n.messages=t.data)},function(t){n.doSomethingWithError(t)})};n.openMenu=function(n,t){a=t;n(t)};n.addProductToFavorites=function(){if(!n.$parent.token){f.error("Please login first!");return}if(n.$parent.favorites.indexOf(n.product)>=0){f.error("This product is allready added!");return}o.postProductToFavorites(n.$parent.user.userName,n.$parent.token,n.product.id).then(function(){n.$parent.favorites.push(n.product);f.success("Product added to Favorites!")},function(t){n.doSomethingWithError(t)})};n.saveMessage=function(){if(n.newMessage)if(n.$parent.token){let i=new Message(null,n.$parent.user.userName,n.newMessage,Date.now(),n.id,!1);t.postMessageForProduct(i,n.$parent.token).then(function(t){t.data&&n.messages.push(t.data);n.newMessage=""},function(t){n.doSomethingWithError(t)})}else f.error("Please login first!")};n.deleteMessage=function(i){n.$parent.token&&t.deleteMessage(n.id,i,n.$parent.token).then(function(t){let i=$.grep(n.messages,function(n){return n.id===t.data}),r=n.messages.indexOf(i);n.messages.splice(r,1)},function(t){n.doSomethingWithError(t)})};n.openImage=function(t){h.open({animation:!0,templateUrl:"Site/gallery/gallery.html",controller:"galleryController",size:"lg",resolve:{images:function(){return n.product.images},index:function(){return t}}})};n.setSelected=function(t){n.selectedImage=n.product.images[t].value};n.doSomethingWithError=function(n){console.log(n)};n.showMeetingPoint=function(){if(n.product.meetingPoint){let t=n.product.meetingPoint.split(";"),i=t[0],r=t[1],u="http://www.google.com/maps/place/"+i+","+r;window.open(u)}};n.init()}app.controller("productController",["$scope","messagesService","productsService","usersService","$routeParams","toastr","$mdDialog","favoritesService","$mdBottomSheet","$uibModal","productNavigationService","$location",productController]);