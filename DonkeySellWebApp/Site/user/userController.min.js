function userController(n,t,i,r,u,f,e,o,s,h,c,l,a){n.username=u.username;n.showEditButtons=n.$parent.username===n.username;n.user={};n.products=[];n.init=function(){c.hasState()===!0&&(h.fromUrl.indexOf("/product/")>-1||h.fromUrl.indexOf("/updateCreateProduct/")>-1)&&c.getUsernameFromState()===n.username?n.getLastState():(n.loading=!0,n.getUser(),n.getUsersProducts(),a.all([n.getUser(),n.getUsersProducts()]).then(()=>{n.loading=!1}))};n.getLastState=function(){let t=c.get();n.username=t.username;n.showEditButtons=t.showEditButtons;n.user=t.user;n.products=t.products};n.setState=function(){let t={};t.username=n.username;t.showEditButtons=n.showEditButtons;t.user=n.user;t.products=n.products;c.set(t)};n.getUsersProducts=function(){return i.getProductsOfUser(n.username).then(function(t){t.data&&(n.products=t.data)},function(t){n.doSomethingWithError(t)})};n.getUser=function(){return t.getUser(n.username).then(function(t){t.data&&(n.user=t.data)},function(t){n.doSomethingWithError(t)})};n.deleteUser=function(){var i=e.confirm().title("Are you sure you want to leave?! :(").ok("Yes, i'm sure!").cancel("No!");e.show(i).then(function(){t.deleteUser(n.username,n.$parent.token).then(function(){n.$parent.logout();r.url("/home");f.success("User deleted!")},function(t){n.doSomethingWithError(t)})})};n.deleteProduct=function(r,u){u.stopPropagation();var o=e.confirm().title("Would you like to delete this product?").ok("Yes, i'm sure!").cancel("No!");e.show(o).then(function(){i.deleteProduct(r,t.getToken()).then(function(){let t=n.products.filter(function(n){return n.id===r})[0],i=n.products.indexOf(t);n.products.splice(i,1);f.success("Product deleted!")},function(t){n.doSomethingWithError(t)})})};n.setProductNavigation=function(){let t=n.products.map(function(n){return n.id});l.setValues("",0,undefined,0,t)};n.getProduct=function(t){n.setProductNavigation();n.setState();r.url("/product/"+t)};n.addToFavorites=function(t,i){if(i.stopPropagation(),!n.$parent.token){f.error("Please login first!");return}if(n.productAllreadyInFav(t.id)){f.error("This product is allready added!");return}o.postProductToFavorites(n.$parent.user.userName,n.$parent.token,t.id).then(function(){n.$parent.favorites.push(t);f.success("Product added to Favorites!")},function(n){console.log(n)})};n.productAllreadyInFav=function(t){let i=n.$parent.favorites.filter(function(n){return n.id===t});return i.length>0?!0:!1};n.changePassword=function(){var t=s.open({animation:!0,templateUrl:"Site/changePassword/changePassword.html",controller:"changePasswordController",resolve:{username:function(){return n.username}}});t.result.then(function(){n.init()})};n.editProduct=function(t,i){i.stopPropagation();n.setState();r.url("/updateCreateProduct/"+t)};n.doSomethingWithError=function(n){console.log(n)};n.init()}app.controller("userController",["$scope","usersService","productsService","$location","$routeParams","toastr","$mdDialog","favoritesService","$uibModal","$rootScope","userStateService","productNavigationService","$q",userController]);