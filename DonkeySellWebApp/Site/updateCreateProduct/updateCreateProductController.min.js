function updateCreateProductController(n,t,i,r,u,f,e,o){n.description="";n.city="";n.product={};n.cities=[];n.categories=[];n.selectedImage="";n.user=n.$parent.user;n.errors=[];n.mapReady=!1;n.marker={};n.map={};n.userName=n.$parent.username;n.productId=f.productId;n.saveProduct=function(){if(n.$parent.token){let u=n.$parent.token;t.addProduct(n.product,u).then(function(){r.success("Product successfully edited!");i.url("/home")},function(t){r.error("An error occured!");n.doSomethingWithError(t)})}else r.error("Please logIn first!")};n.init=function(){n.productId==="0"?(n.product=new Product,n.product.userName=n.user.userName,n.product.userMail=n.user.email,n.product.userId=n.user.userId,n.product.images=[],n.setCoordinates()):t.getProduct(n.productId).then(function(t){if(t.data)if(n.product=t.data,n.selectedImage=n.product.images.length>0?n.product.images[0].value:"",n.product.meetingPoint){let t=n.product.meetingPoint.split(";");n.latitude=t[0];n.longitude=t[1];n.setCoordinatesForMarkerAndMap()}else n.setCoordinates()},function(t){r.error("An error occured");n.doSomethingWithError(t)});n.getCategoriesAndCities()};n.getCategoriesAndCities=function(){n.categories=n.$parent.categories;n.cities=n.$parent.cities};n.addImageToProduct=function(t){let i=new Image(null,t);n.$apply(function(){n.product.images.push(i)});n.selectedImage||(n.selectedImage=t)};n.showAlert=function(){e.show(e.alert().clickOutsideToClose(!0).title("Warning").textContent("You allready have added 3 images. Remove the ones you want to replace").ok("Got it!"))};n.removeImage=function(t){let i=n.product.images.indexOf(t);n.product.images.splice(i,1);n.selectedImage===t.value&&(n.selectedImage="")};n.processFiles=function(t){if(n.product.images.length>=3){n.showAlert();return}for(let i=0;i<t.length;i++){let r=!1;if(t[i].size>2097152&&(n.errors.push(t[i].name+" is to big! :("),r=!0),r===!0)return}angular.forEach(t,function(t){var i=new FileReader;i.onload=function(t){var i=t.target.result;n.addImageToProduct(i)};i.readAsDataURL(t.file)})};n.setMainImage=function(t){n.selectedImage=t.value};n.doSomethingWithError=function(n){console.log(n)};n.setCoordinates=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){n.latitude=t.coords.latitude;n.longitude=t.coords.longitude;n.setCoordinatesForMarkerAndMap()})};n.setCoordinatesForMarkerAndMap=function(){o.then(function(){n.marker={id:0,options:{draggable:!0},coords:{latitude:n.latitude,longitude:n.longitude},events:{dragend:function(t){let i=t.getPosition().lat(),r=t.getPosition().lng();n.product.meetingPoint=i+";"+r}}};n.map={center:{latitude:n.latitude,longitude:n.longitude},zoom:14};n.mapReady=!0})};n.init()}app.controller("updateCreateProductController",["$scope","productsService","$location","toastr","usersService","$routeParams","$mdDialog","uiGmapGoogleMapApi",updateCreateProductController]);